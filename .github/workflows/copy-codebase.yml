name: ðŸš€ Deploy Codebase to Hetzner Server (HEALOTAC)

on:
  push:
    branches:
      - main  

jobs:
  deploy-to-hetzner-server:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ§© Checkout repository
        uses: actions/checkout@v4

      # - name: ðŸ”‘ Configure SSH
      #   run: |
      #     mkdir -p ~/.ssh
      #     echo "${{ secrets.HETZNER_SSH_KEY }}" > ~/.ssh/hetzner_key
      #     chmod 600 ~/.ssh/hetzner_key
      #     ssh-keyscan -H ${{ secrets.HETZNER_SERVER_IP }} >> ~/.ssh/known_hosts

      # - name: ðŸ“‚ Copy codebase to Hetzner
      #   run: |
      #     echo "Deploying to /root/HEALOTAC on ${{ secrets.HETZNER_SERVER_IP }} ..."
      #     rsync -avz --delete -e "ssh -i ~/.ssh/hetzner_key" ./ root@${{ secrets.HETZNER_SERVER_IP }}:/root/HEALOTAC/

      # - name: ðŸš€ Restart Application via PM2 (Production Mode)
      #   run: |
      #     ssh -i ~/.ssh/hetzner_key root@${{ secrets.HETZNER_SERVER_IP }} << 'EOF'
      #       cd /root/HEALOTAC
      #       echo "ðŸ›‘ Stopping existing PM2 processes..."
      #       pm2 delete all || true

      #       echo "ðŸ“¦ Installing dependencies..."
      #       npm i

      #       echo "ðŸ—ï¸ Building the project..."
      #       npm run build

      #       echo "ðŸš€ Starting app with PM2..."
      #       pm2 start npm --name "healotac" -- run start

      #       echo "ðŸ’¾ Saving PM2 process list..."
      #       pm2 save
