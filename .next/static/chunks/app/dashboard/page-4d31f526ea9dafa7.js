(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{2343:function(e,t,a){Promise.resolve().then(a.bind(a,1092))},1092:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var r=a(7437),s=a(2265),l=a(9893),d=a(5805);let n=(0,a(9205).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var i=a(7648);let c=()=>(0,r.jsxs)("svg",{viewBox:"0 0 800 80",className:"w-full h-12",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"ecgGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#ef4444"}),(0,r.jsx)("stop",{offset:"25%",stopColor:"#dc2626"}),(0,r.jsx)("stop",{offset:"50%",stopColor:"#b91c1c"}),(0,r.jsx)("stop",{offset:"75%",stopColor:"#dc2626"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#ef4444"})]})}),(0,r.jsx)("path",{d:"M0 40 L50 40 L52 32 L54 48 L56 20 L58 60 L60 40 L90 40 L92 36 L94 44 L96 12 L98 68 L100 40 L130 40 L132 32 L134 48 L136 20 L138 60 L140 40 L170 40 L172 36 L174 44 L176 12 L178 68 L180 40 L210 40 L212 32 L214 48 L216 20 L218 60 L220 40 L250 40 L252 36 L254 44 L256 12 L258 68 L260 40 L290 40 L292 32 L294 48 L296 20 L298 60 L300 40 L330 40 L332 36 L334 44 L336 12 L338 68 L340 40 L370 40 L372 32 L374 48 L376 20 L378 60 L380 40 L410 40 L412 36 L414 44 L416 12 L418 68 L420 40 L450 40 L452 32 L454 48 L456 20 L458 60 L460 40 L490 40 L492 36 L494 44 L496 12 L498 68 L500 40 L530 40 L532 32 L534 48 L536 20 L538 60 L540 40 L570 40 L572 36 L574 44 L576 12 L578 68 L580 40 L610 40 L612 32 L614 48 L616 20 L618 60 L620 40 L650 40 L652 36 L654 44 L656 12 L658 68 L660 40 L690 40 L692 32 L694 48 L696 20 L698 60 L700 40 L730 40 L732 36 L734 44 L736 12 L738 68 L740 40 L770 40 L772 32 L774 48 L776 20 L778 60 L780 40 L800 40",stroke:"url(#ecgGradient)",strokeWidth:"3.5",fill:"none"}),(0,r.jsx)("defs",{children:(0,r.jsx)("style",{children:"\n          @keyframes ecgFlow {\n            0% { stroke-dasharray: 0, 1600; }\n            50% { stroke-dasharray: 800, 800; }\n            100% { stroke-dasharray: 1600, 0; }\n          }\n          path {\n            animation: ecgFlow 5s linear infinite;\n          }\n        "})})]});function o(){let[e,t]=(0,s.useState)([]),[a,o]=(0,s.useState)([]),[x,m]=(0,s.useState)(!0),[h,g]=(0,s.useState)("checking..."),[u,p]=(0,s.useState)(!1),[f,y]=(0,s.useState)([]),j=(0,s.useRef)(null),[L,k]=(0,s.useState)(!1),[v,N]=(0,s.useState)(null),b=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=localStorage.getItem("jwt_token");e?(N(e),k(!0)):window.location.href="/login"},[]);let w=(0,s.useCallback)(async()=>{if(v){g("connecting...");try{let e={Authorization:"Bearer ".concat(v),"Content-Type":"application/json"},[a,r]=await Promise.all([fetch("/api/cadets",{headers:e}),fetch("/api/medical-records",{headers:e})]);if(a.ok&&r.ok){let e=await a.json(),s=await r.json();t(e),o(s),g("connected (".concat(e.length," cadets, ").concat(s.length," records)")),console.log("✅ Real-time data updated:",new Date().toLocaleTimeString())}else{if(401===a.status||401===r.status){localStorage.removeItem("jwt_token"),window.location.href="/login";return}g("api error (".concat(a.status,", ").concat(r.status,")")),t([]),o([])}}catch(e){g("connection failed: ".concat(e instanceof Error?e.message:"unknown error")),t([]),o([])}finally{m(!1)}}},[v]);(0,s.useEffect)(()=>{if(L&&v)return w(),b.current=setInterval(()=>{console.log("\uD83D\uDD04 Polling for real-time data updates..."),w()},3e4),()=>{b.current&&clearInterval(b.current)}},[L,v,w]);let S=new Date,C=S.getFullYear()+"-"+String(S.getMonth()+1).padStart(2,"0")+"-"+String(S.getDate()).padStart(2,"0"),D=a.filter(e=>{let t=e.createdAt.split("T")[0],a=e.updatedAt?e.updatedAt.split("T")[0]:null;return t===C||a&&a===C}),A=new Set(D.map(e=>e.cadetId)),E=[...new Set(D.map(e=>e.name))],M=[{label:"Total Cadets for Today",value:A.size.toString(),icon:d.Z}],R=e.map(e=>({...e,lastActivity:e.createdAt})).sort((e,t)=>new Date(t.lastActivity).getTime()-new Date(e.lastActivity).getTime()).slice(0,5);return x?(0,r.jsx)(l.default,{children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading dashboard..."})]})})}):(0,r.jsx)(l.default,{children:(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Dashboard"}),(0,r.jsx)("p",{className:"mt-1 text-gray-500 dark:text-gray-400",children:"Real-time overview of medical records and cadet health status"})]}),(0,r.jsxs)("div",{className:"mt-4 lg:mt-0 flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>{console.log("\uD83D\uDD04 Manual refresh triggered"),w()},className:"inline-flex items-center p-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",title:"Refresh data",children:(0,r.jsx)(n,{className:"h-4 w-4"})}),(0,r.jsx)(i.default,{href:"/medical-records/new",className:"btn-primary",children:"Add New Record"})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-1 lg:grid-cols-1 gap-6",children:M.map(e=>{let t=e.icon;return(0,r.jsxs)("div",{className:"card p-6 relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)(c,{})}),(0,r.jsx)("div",{className:"relative z-10",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.label}),(0,r.jsx)("div",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:e.value})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"p-2 bg-primary/10 dark:bg-primary/20 rounded-lg cursor-pointer transition-all hover:bg-primary/20 dark:hover:bg-primary/30",onMouseEnter:()=>{y(E.length>0?E:["No cadets with records today"]),p(!0)},onMouseLeave:()=>{p(!1)},children:(0,r.jsx)(t,{className:"h-5 w-5 text-primary"})}),u&&(0,r.jsxs)("div",{ref:j,className:"absolute bottom-full right-0 mb-2 w-64 max-h-48 bg-gray-900 text-white text-sm rounded-lg shadow-lg z-50 overflow-hidden animate-fade-in",children:[(0,r.jsx)("div",{className:"p-3 border-b border-gray-700",children:(0,r.jsxs)("strong",{children:["Cadets with Records Today (",E.length,")"]})}),(0,r.jsx)("div",{className:"max-h-32 overflow-y-auto",children:f.map((e,t)=>(0,r.jsx)("div",{className:"px-3 py-2 border-b border-gray-700 last:border-b-0 hover:bg-gray-800 transition-colors",children:e},t))})]})]})]})})]},e.label)})}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Cadet Activity"}),(0,r.jsx)(i.default,{href:"/cadets",className:"text-sm text-primary hover:text-primary/80",children:"View all cadets →"})]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800/50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Cadet Name"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Battalion"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Company"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Join Date"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Last Activity"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:R.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-10 w-10 flex-shrink-0 rounded-full bg-primary/10 dark:bg-primary/20 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-primary font-medium",children:e.name.split(" ").map(e=>e[0]).join("")})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name})})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.battalion})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.company})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(e.joinDate).toLocaleDateString()})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("Active"===e.status?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"),children:e.status})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(e.lastActivity||e.createdAt).toLocaleDateString()})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)(i.default,{href:"/cadets/".concat(e.id),className:"text-primary hover:text-primary/80 font-medium text-sm",children:"View Cadet"})})]},e.id))})]})})]})]})})}},9893:function(e,t,a){"use strict";a.d(t,{default:function(){return N}});var r=a(7437),s=a(2265),l=a(9376),d=a(8293),n=a(2369),i=a(5929),c=a(7226);function o(){let[e,t]=(0,s.useState)("dark");return(0,s.useEffect)(()=>{let e=localStorage.getItem("theme");if(e)t(e),document.documentElement.classList.toggle("dark","dark"===e),document.documentElement.classList.toggle("light","light"===e);else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";t(e),document.documentElement.classList.toggle("dark","dark"===e),document.documentElement.classList.toggle("light","light"===e)}},[]),(0,r.jsx)("button",{onClick:()=>{let a="dark"===e?"light":"dark";t(a),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(a),localStorage.setItem("theme",a)},className:"p-2 rounded-full text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",title:"Switch to ".concat("dark"===e?"light":"dark"," mode"),children:"dark"===e?(0,r.jsx)(i.Z,{className:"h-5 w-5"}):(0,r.jsx)(c.Z,{className:"h-5 w-5"})})}let x=e=>{let{className:t=""}=e;return(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,r.jsx)("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),(0,r.jsx)("path",{d:"M12 7v6M10 10h4",stroke:"currentColor",strokeWidth:"2"})]})};function m(){let[e,t]=(0,s.useState)("");return(0,s.useEffect)(()=>{let e=localStorage.getItem("user_info");if(e)try{let a=JSON.parse(e);t(a.username||a.name||"User")}catch(e){t("User")}},[]),(0,r.jsx)("header",{className:"border-b border-gray-200 dark:border-gray-700/50 bg-white dark:bg-gray-800/50",children:(0,r.jsx)("div",{className:"px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("button",{className:"lg:hidden p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,r.jsx)(d.Z,{className:"h-6 w-6"})}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(x,{className:"w-8 h-8 text-primary"}),(0,r.jsx)("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"CURACADET"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(o,{}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Welcome, ",e||"User"]}),(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center",children:(0,r.jsx)(n.Z,{className:"h-5 w-5 text-primary"})})]})]})]})})})}var h=a(7648),g=a(4938),u=a(5805),p=a(4401),f=a(9397),y=a(8736),j=a(7692);let L=e=>{let{className:t=""}=e;return(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,r.jsx)("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),(0,r.jsx)("path",{d:"M12 7v6M10 10h4",stroke:"currentColor",strokeWidth:"2"})]})},k=[{name:"Dashboard",href:"/dashboard",icon:g.Z},{name:"Cadet Records",href:"/cadets",icon:u.Z},{name:"Medical History",href:"/medical-history",icon:p.Z},{name:"Add Record",href:"/medical-records/new",icon:f.Z},{name:"Reports",href:"/reports",icon:y.Z}];function v(){let e=(0,l.usePathname)(),t=(0,l.useRouter)();return(0,r.jsxs)("aside",{className:"w-64 flex-col bg-white dark:bg-gray-800/50 border-r border-gray-200 dark:border-gray-700/50 p-4 hidden lg:flex",children:[(0,r.jsx)("div",{className:"flex flex-col gap-y-2 mb-8",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(L,{className:"w-8 h-8 text-primary"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"CURACADET"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Attendant Portal"})]})]})}),(0,r.jsx)("nav",{className:"flex-1 flex flex-col gap-2",children:k.map(t=>{let a=t.icon,s=e===t.href;return(0,r.jsxs)(h.default,{href:t.href,className:"\n                flex items-center gap-3 rounded-lg px-3 py-2 font-medium\n                ".concat(s?"bg-primary/10 dark:bg-primary/20 text-primary dark:text-white":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800","\n              "),children:[(0,r.jsx)(a,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:t.name})]},t.name)})}),(0,r.jsxs)("button",{onClick:()=>{localStorage.removeItem("jwt_token"),localStorage.removeItem("user_info"),t.push("/")},className:"flex items-center gap-3 rounded-lg px-3 py-2 font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 mt-auto",children:[(0,r.jsx)(j.Z,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"Logout"})]})]})}function N(e){let{children:t}=e,a=(0,l.useRouter)();return(0,s.useEffect)(()=>{localStorage.getItem("jwt_token")||a.push("/")},[a]),(0,r.jsxs)("div",{className:"flex min-h-screen",children:[(0,r.jsx)(v,{}),(0,r.jsx)("div",{className:"w-px bg-gray-200 dark:bg-gray-700/50"}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,r.jsx)(m,{}),(0,r.jsx)("main",{className:"flex-1 p-6 lg:p-8 bg-background-light dark:bg-background-dark",children:t})]})]})}}},function(e){e.O(0,[631,971,117,744],function(){return e(e.s=2343)}),_N_E=e.O()}]);