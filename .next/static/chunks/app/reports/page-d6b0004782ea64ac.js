(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[882],{2652:function(e,t,a){Promise.resolve().then(a.bind(a,1450))},1450:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var r=a(7437),s=a(2265),d=a(7357),l=a(4241),c=a(933),n=a(404),i=a(7164),o=a(2023),x=a(6235);function m(){let[e,t]=(0,s.useState)("today"),[a,m]=(0,s.useState)([]),[g,h]=(0,s.useState)([]),[y,u]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!0),[b,j]=(0,s.useState)(""),[k,N]=(0,s.useState)(""),[w,v]=(0,s.useState)(!1),C=async()=>{try{f(!0);let e=localStorage.getItem("jwt_token");if(!e){console.error("No authentication token found"),h([]),m([]);return}let t=await fetch("/api/medical-records",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();h(e),m(e)}else console.error("Failed to fetch medical records"),h([]),m([])}catch(e){console.error("Error fetching medical records:",e),h([]),m([])}finally{f(!1)}};(0,s.useEffect)(()=>{C()},[]),(0,s.useEffect)(()=>{if(w&&b&&k)m(g.filter(e=>{let t=new Date(e.dateOfReporting),a=new Date(b),r=new Date(k+"T23:59:59");return t>=a&&t<=r}));else if(w||"all"===e)m(g);else{let t=new Date,a=new Date;switch(e){case"yesterday":(a=new Date(t)).setDate(t.getDate()-1),a.setHours(0,0,0,0);let r=new Date(a);r.setHours(23,59,59,999),m(g.filter(e=>{let t=new Date(e.dateOfReporting);return t>=a&&t<=r}));return;case"today":(a=new Date(t)).setHours(0,0,0,0),m(g.filter(e=>{let r=new Date(e.dateOfReporting);return r>=a&&r<=t}));return;case"week":a.setDate(t.getDate()-7);break;default:m(g);return}m(g.filter(e=>new Date(e.dateOfReporting)>=a))}},[e,w,b,k,g]);let D=e=>{t(e),v(!1),j(""),N("")},S=e=>{if(w&&b&&k)return"Custom (".concat(b," to ").concat(k,")");switch(e){case"yesterday":return"Yesterday";case"today":return"Today";case"week":return"Last Week";default:return"All Records"}};return(0,r.jsx)(d.default,{children:(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Reports"}),(0,r.jsx)("p",{className:"mt-1 text-gray-500 dark:text-gray-400",children:"Generate and download medical records reports"})]})}),(0,r.jsxs)("div",{className:"card p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Time Period Filters"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,r.jsxs)("button",{onClick:()=>D("yesterday"),className:"p-4 rounded-lg border-2 ".concat(w||"yesterday"!==e?"border-gray-200 dark:border-gray-700 hover:border-primary/50":"border-primary bg-primary/10 dark:bg-primary/20 text-primary"),disabled:w,children:[(0,r.jsx)(l.Z,{className:"h-6 w-6 mx-auto mb-2"}),(0,r.jsx)("div",{className:"text-sm font-medium",children:"Yesterday"}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Previous day"})]}),(0,r.jsxs)("button",{onClick:()=>D("today"),className:"p-4 rounded-lg border-2 ".concat(w||"today"!==e?"border-gray-200 dark:border-gray-700 hover:border-primary/50":"border-primary bg-primary/10 dark:bg-primary/20 text-primary"),disabled:w,children:[(0,r.jsx)(c.Z,{className:"h-6 w-6 mx-auto mb-2"}),(0,r.jsx)("div",{className:"text-sm font-medium",children:"Today"}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Current day"})]}),(0,r.jsxs)("button",{onClick:()=>D("week"),className:"p-4 rounded-lg border-2 ".concat(w||"week"!==e?"border-gray-200 dark:border-gray-700 hover:border-primary/50":"border-primary bg-primary/10 dark:bg-primary/20 text-primary"),disabled:w,children:[(0,r.jsx)(n.Z,{className:"h-6 w-6 mx-auto mb-2"}),(0,r.jsx)("div",{className:"text-sm font-medium",children:"Week"}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Last 7 days"})]}),(0,r.jsxs)("button",{onClick:()=>{v(!w),w||(j(""),N(""))},className:"p-4 rounded-lg border-2 ".concat(w?"border-primary bg-primary/10 dark:bg-primary/20 text-primary":"border-gray-200 dark:border-gray-700 hover:border-primary/50"),children:[(0,r.jsx)(l.Z,{className:"h-6 w-6 mx-auto mb-2"}),(0,r.jsx)("div",{className:"text-sm font-medium",children:"Custom Date"}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Select range"})]})]}),w&&(0,r.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[(0,r.jsx)("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-4",children:"Select Custom Date Range"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Start Date *"}),(0,r.jsx)("input",{type:"date",id:"startDate",value:b,onChange:e=>j(e.target.value),className:"input-field"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"End Date *"}),(0,r.jsx)("input",{type:"date",id:"endDate",value:k,onChange:e=>N(e.target.value),className:"input-field"})]}),(0,r.jsxs)("div",{className:"flex items-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>{if(b&&k){if(new Date(b)>new Date(k)){alert("Start date cannot be after end date");return}console.log("Custom date range applied:",b,"to",k)}},disabled:!b||!k,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex-1",children:"Apply Range"}),(0,r.jsx)("button",{onClick:()=>{v(!1),j(""),N(""),t("today")},className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600",children:"Cancel"})]})]})]})]}),(0,r.jsx)("div",{className:"card p-6",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[S(e)," Report"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",a.length," of ",g.length," records","all"!==e&&" (".concat(S(e),")")]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-3",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-primary",children:p?"...":a.length}),(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p?"Loading records...":"records found"})]})]}),(0,r.jsxs)("button",{onClick:()=>{if(0===a.length){alert("No data available for the selected time period.");return}u(!0),setTimeout(()=>{let t=new Blob([["ID,Cadet ID,Name,Company,Battalion,Date of Reporting,Medical Problem,Diagnosis,Status,Attend C,Training Days Missed,Monitoring Case,Contact No,Remarks,Created At",...a.map(e=>[e.id,e.cadetId,'"'.concat(e.name,'"'),'"'.concat(e.company,'"'),'"'.concat(e.battalion,'"'),e.dateOfReporting,'"'.concat(e.medicalProblem,'"'),'"'.concat(e.diagnosis||"",'"'),e.status,e.attendC,e.trainingDaysMissed||0,e.monitoringCase?"Yes":"No",'"'.concat(e.contactNo||"",'"'),'"'.concat(e.remarks||"",'"'),e.createdAt].join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),s=URL.createObjectURL(t);r.setAttribute("href",s),r.setAttribute("download",w&&b&&k?"curacadet-reports-".concat(b,"-to-").concat(k,".csv"):"curacadet-reports-".concat(e,"-").concat((0,x.WU)(new Date,"yyyy-MM-dd"),".csv")),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),u(!1)},1e3)},disabled:y||0===a.length||p,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4 mr-2"}),y?"Generating...":"Download CSV"]})]})}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Data Preview"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Preview of records that will be included in the CSV export"})]}),a.length>0?(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800/50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Name"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Company"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Battalion"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Medical Problem"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Monitoring Case"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Date Reported"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:a.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.company})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.battalion})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.medicalProblem})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("Active"===e.status?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"),children:e.status})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.monitoringCase?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400":"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"),children:e.monitoringCase?"Yes":"No"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(e.dateOfReporting).toLocaleDateString()})})]},e.id))})]})}):p?(0,r.jsx)("div",{className:"p-12 text-center",children:(0,r.jsxs)("div",{className:"text-gray-500 dark:text-gray-400",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-lg",children:"Loading medical records..."}),(0,r.jsx)("p",{className:"text-sm mt-2",children:"Please wait while we fetch the data."})]})}):(0,r.jsx)("div",{className:"p-12 text-center",children:(0,r.jsxs)("div",{className:"text-gray-500 dark:text-gray-400",children:[(0,r.jsx)(o.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,r.jsx)("p",{className:"text-lg mb-2",children:"No records found"}),(0,r.jsx)("p",{className:"text-sm",children:"No medical records available for the selected time period."}),(0,r.jsx)("p",{className:"text-sm mt-2 text-gray-400 dark:text-gray-500",children:"Add records through the medical records form to see them here."})]})})]})]})})}},7357:function(e,t,a){"use strict";a.d(t,{default:function(){return w}});var r=a(7437),s=a(2265),d=a(6463),l=a(2873),c=a(2022),n=a(8296),i=a(2699);function o(){let[e,t]=(0,s.useState)("dark");return(0,s.useEffect)(()=>{let e=localStorage.getItem("theme");if(e)t(e),document.documentElement.classList.toggle("dark","dark"===e),document.documentElement.classList.toggle("light","light"===e);else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";t(e),document.documentElement.classList.toggle("dark","dark"===e),document.documentElement.classList.toggle("light","light"===e)}},[]),(0,r.jsx)("button",{onClick:()=>{let a="dark"===e?"light":"dark";t(a),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(a),localStorage.setItem("theme",a)},className:"p-2 rounded-full text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",title:"Switch to ".concat("dark"===e?"light":"dark"," mode"),children:"dark"===e?(0,r.jsx)(n.Z,{className:"h-5 w-5"}):(0,r.jsx)(i.Z,{className:"h-5 w-5"})})}let x=e=>{let{className:t=""}=e;return(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,r.jsx)("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),(0,r.jsx)("path",{d:"M12 7v6M10 10h4",stroke:"currentColor",strokeWidth:"2"})]})};function m(){let[e,t]=(0,s.useState)("");return(0,s.useEffect)(()=>{let e=localStorage.getItem("user_info");if(e)try{let a=JSON.parse(e);t(a.username||a.name||"User")}catch(e){t("User")}},[]),(0,r.jsx)("header",{className:"border-b border-gray-200 dark:border-gray-700/50 bg-white dark:bg-gray-800/50",children:(0,r.jsx)("div",{className:"px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("button",{className:"lg:hidden p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,r.jsx)(l.Z,{className:"h-6 w-6"})}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(x,{className:"w-8 h-8 text-primary"}),(0,r.jsx)("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"CURACADET"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(o,{}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Welcome, ",e||"User"]}),(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center",children:(0,r.jsx)(c.Z,{className:"h-5 w-5 text-primary"})})]})]})]})})})}var g=a(7138),h=a(3852),y=a(1240),u=a(4207),p=a(2513),f=a(2023),b=a(9896);let j=e=>{let{className:t=""}=e;return(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,r.jsx)("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),(0,r.jsx)("path",{d:"M12 7v6M10 10h4",stroke:"currentColor",strokeWidth:"2"})]})},k=[{name:"Dashboard",href:"/dashboard",icon:h.Z},{name:"Cadet Records",href:"/cadets",icon:y.Z},{name:"Medical History",href:"/medical-history",icon:u.Z},{name:"Add Record",href:"/medical-records/new",icon:p.Z},{name:"Reports",href:"/reports",icon:f.Z}];function N(){let e=(0,d.usePathname)(),t=(0,d.useRouter)();return(0,r.jsxs)("aside",{className:"w-64 flex-col bg-white dark:bg-gray-800/50 border-r border-gray-200 dark:border-gray-700/50 p-4 hidden lg:flex",children:[(0,r.jsx)("div",{className:"flex flex-col gap-y-2 mb-8",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(j,{className:"w-8 h-8 text-primary"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"CURACADET"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Attendant Portal"})]})]})}),(0,r.jsx)("nav",{className:"flex-1 flex flex-col gap-2",children:k.map(t=>{let a=t.icon,s=e===t.href;return(0,r.jsxs)(g.default,{href:t.href,className:"\n                flex items-center gap-3 rounded-lg px-3 py-2 font-medium\n                ".concat(s?"bg-primary/10 dark:bg-primary/20 text-primary dark:text-white":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800","\n              "),children:[(0,r.jsx)(a,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:t.name})]},t.name)})}),(0,r.jsxs)("button",{onClick:()=>{localStorage.removeItem("jwt_token"),localStorage.removeItem("user_info"),t.push("/")},className:"flex items-center gap-3 rounded-lg px-3 py-2 font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 mt-auto",children:[(0,r.jsx)(b.Z,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"Logout"})]})]})}function w(e){let{children:t}=e,a=(0,d.useRouter)();return(0,s.useEffect)(()=>{localStorage.getItem("jwt_token")||a.push("/")},[a]),(0,r.jsxs)("div",{className:"flex min-h-screen",children:[(0,r.jsx)(N,{}),(0,r.jsx)("div",{className:"w-px bg-gray-200 dark:bg-gray-700/50"}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,r.jsx)(m,{}),(0,r.jsx)("main",{className:"flex-1 p-6 lg:p-8 bg-background-light dark:bg-background-dark",children:t})]})]})}}},function(e){e.O(0,[841,608,971,23,744],function(){return e(e.s=2652)}),_N_E=e.O()}]);