(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[363],{8199:function(e,t,a){Promise.resolve().then(a.bind(a,6134))},3229:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},5868:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},2489:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6134:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});var s=a(7437),r=a(9376),i=a(9893),c=a(2660),l=a(9205);let d=(0,l.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var n=a(1047),x=a(8736),m=a(1723);let o=(0,l.Z)("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]),h=(0,l.Z)("Weight",[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]]);var g=a(3229),p=a(2489),u=a(5868),y=a(5805);let j=(0,l.Z)("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);var f=a(2369),N=a(9397),v=a(4401),w=a(7648),k=a(6663),b=a(2265);function E(e){let{params:t}=e,a=(0,r.useRouter)(),l=(0,r.useSearchParams)(),E=parseInt(t.id),[D,C]=(0,b.useState)(null),[Z,S]=(0,b.useState)([]),[R,M]=(0,b.useState)(!0),[A,T]=(0,b.useState)(null),[P,I]=(0,b.useState)(!1),[L,F]=(0,b.useState)(""),[H,O]=(0,b.useState)(!1),_=(0,b.useCallback)(async()=>{try{var e;console.log("\uD83D\uDCE1 FETCHING CADET DATA for cadet ".concat(E)),M(!0),T(null);let t=localStorage.getItem("jwt_token");if(!t){T("Authentication required");return}let a={Authorization:"Bearer ".concat(t)},[s,r]=await Promise.all([fetch("/api/cadets/".concat(E),{headers:a}),fetch("/api/medical-history/".concat(E),{headers:a})]);if(!s.ok)throw Error("Failed to fetch cadet");let i=await s.json(),c=r.ok?await r.json():{records:[]},{records:l}=c;console.log("✅ RECEIVED CADET DATA:",i),console.log("✅ RAW RECORDS RESPONSE:",c),console.log("✅ RECEIVED MEDICAL RECORDS:",l.length,"records"),console.log("✅ RECORDS RESPONSE STATUS:",r.status,r.ok),C(i),S(l),F((null===(e=i.weight)||void 0===e?void 0:e.toString())||"")}catch(e){console.error("❌ Error loading cadet details:",e),T(e instanceof Error?e.message:"Failed to load cadet details")}finally{M(!1)}},[E]);(0,b.useEffect)(()=>{console.log("\uD83D\uDD04 USEEFFECT TRIGGERED: cadetId=".concat(E)),_()},[E,_]),(0,b.useEffect)(()=>{"true"===l.get("refresh")&&(console.log("\uD83D\uDD04 DETECTED REFRESH PARAMETER - refreshing data directly"),a.replace(window.location.pathname),_())},[l,_,a]);let q=async()=>{if(D)try{O(!0);let e=L?parseInt(L):void 0;if(!(await fetch("/api/cadets/".concat(E),{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({weight:e})})).ok)throw Error("Failed to update weight");C({...D,weight:e}),I(!1)}catch(e){console.error("Error updating weight:",e),alert("Failed to update weight. Please try again.")}finally{O(!1)}},z=Z.reduce((e,t)=>{let a=t.totalTrainingDaysMissed||0;return t.exPpg&&(a+=.25*t.exPpg),t.attendB&&(a+=.25*t.attendB),e+a},0);return R?(0,s.jsx)(i.Z,{children:(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):A||!D?(0,s.jsx)(i.Z,{children:(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:A||"Cadet not found"}),(0,s.jsx)(w.default,{href:"/cadets",className:"text-primary hover:text-primary/80",children:"Return to Cadets Page"})]})})}):(0,s.jsx)(i.Z,{children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(w.default,{href:"/cadets",className:"inline-flex items-center gap-2 text-primary hover:text-primary/80 transition-colors",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4"}),"Back to Cadets"]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400",children:"Cadet ID"}),(0,s.jsxs)("div",{className:"text-2xl font-bold text-primary",children:["#",E]})]})})]}),(0,s.jsx)("div",{className:"card p-6",children:(0,s.jsx)("div",{className:"flex items-start justify-between",children:(0,s.jsxs)("div",{className:"flex items-start gap-6",children:[(0,s.jsx)("div",{className:"h-20 w-20 rounded-full bg-primary/10 dark:bg-primary/20 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-primary font-bold text-2xl",children:D.name.split(" ").map(e=>e[0]).join("")})}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[D.name,"Y"===D.relegated&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-red-600 dark:text-red-400 font-bold",children:"R"}),(0,s.jsx)("span",{className:"w-3 h-3 bg-red-500 rounded-full"})]})]}),(0,s.jsx)(w.default,{href:"/cadets/".concat(E,"/edit"),className:"inline-flex items-center justify-center p-2 text-gray-400 hover:text-primary hover:bg-primary/10 rounded-lg transition-colors",title:"Edit cadet information",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,s.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 mb-4",children:[(0,s.jsx)(d,{className:"h-4 w-4"}),(0,s.jsxs)("span",{children:[D.company," Company, ",D.battalion]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.Z,{className:"h-4 w-4 text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Join Date"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:new Date(D.joinDate).toLocaleDateString()})]})]}),D.academyNumber&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4 text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Academy Number"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:D.academyNumber})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4 text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Medical Records"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:Z.length})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m.Z,{className:"h-4 w-4 text-red-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Total Days Missed"}),(0,s.jsx)("p",{className:"text-sm font-medium text-red-600 dark:text-red-400",children:z})]})]})]}),(D.height||D.weight||D.age||D.course||D.sex||D.academyNumber)&&(0,s.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Demographics"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[D.height&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o,{className:"h-4 w-4 text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Height"}),(0,s.jsxs)("p",{className:"text-sm font-medium",children:[D.height," cm"]})]})]}),D.weight&&(0,s.jsxs)("div",{className:"flex items-center gap-2 group",children:[(0,s.jsx)(h,{className:"h-4 w-4 text-primary"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Weight"}),P?(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)("input",{type:"number",value:L,onChange:e=>F(e.target.value),className:"text-sm px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white w-20",placeholder:"kg",min:"0",disabled:H}),(0,s.jsx)("button",{onClick:q,disabled:H,className:"p-1 text-green-600 hover:text-green-700 disabled:opacity-50",title:"Save weight",children:H?(0,s.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-green-600"}):(0,s.jsx)(g.Z,{className:"h-3 w-3"})}),(0,s.jsx)("button",{onClick:()=>{var e;I(!1),F((null===(e=D.weight)||void 0===e?void 0:e.toString())||"")},disabled:H,className:"p-1 text-red-600 hover:text-red-700 disabled:opacity-50",title:"Cancel editing",children:(0,s.jsx)(p.Z,{className:"h-3 w-3"})})]}):(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("p",{className:"text-sm font-medium",children:[D.weight," kg"]}),(0,s.jsx)("button",{onClick:()=>I(!0),className:"opacity-0 group-hover:opacity-100 p-1 text-gray-400 hover:text-primary transition-opacity",title:"Edit weight",children:(0,s.jsx)(u.Z,{className:"h-3 w-3"})})]})]})]}),D.age&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(y.Z,{className:"h-4 w-4 text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Age"}),(0,s.jsxs)("p",{className:"text-sm font-medium",children:[D.age," years"]})]})]}),D.course&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(j,{className:"h-4 w-4 text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Course"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:D.course})]})]}),D.sex&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(f.Z,{className:"h-4 w-4 text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Sex"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:D.sex})]})]})]})]}),!(D.height||D.weight||D.age||D.course||D.sex||D.academyNumber)&&(0,s.jsx)("div",{className:"mt-6"})]})]})})}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,s.jsx)("div",{className:"flex items-start justify-between",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Medical History"}),(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsx)(w.default,{href:"/medical-records/new?cadetId=".concat(E),className:"inline-flex items-center justify-center p-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors",title:"Add another medical record",children:(0,s.jsx)(N.Z,{className:"h-4 w-4"})})})]}),(0,s.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:["Complete medical record history for ",D.name]})]})})}),(0,s.jsx)("div",{className:"p-6",children:0===Z.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(v.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Medical Records"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"This cadet has no medical records yet."})]}):(0,s.jsx)(k.Z,{records:Z,cadetId:E,showAll:!0})})]})]})})}}},function(e){e.O(0,[631,196,971,117,744],function(){return e(e.s=8199)}),_N_E=e.O()}]);