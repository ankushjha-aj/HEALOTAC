"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},5013:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>_,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>N,staticGenerationAsyncStorage:()=>h});var a={};r.r(a),r.d(a,{POST:()=>c});var s=r(9303),n=r(8716),o=r(670),l=r(7070),u=r(8691),i=r(5748),d=r(7327),p=r(7745);async function c(e){try{let{username:t,password:r,email:a,role:s}=await e.json();if(!t||!r)return l.NextResponse.json({error:"Username and password are required"},{status:400});let[n]=await i.db.select().from(d.rC).where((0,p.eq)(d.rC.username,t)).limit(1);if(n)return l.NextResponse.json({error:"Username already exists"},{status:409});let o=await u.ZP.hash(r,12),[c]=await i.db.insert(d.rC).values({username:t,password:o,email:a,role:s||"user"}).returning({id:d.rC.id,username:d.rC.username,email:d.rC.email,role:d.rC.role,createdAt:d.rC.createdAt});return l.NextResponse.json({message:"User created successfully",user:c})}catch(e){return console.error("Registration error:",e),l.NextResponse.json({error:"Internal server error"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"/Users/ankushjha/Desktop/CURACADET/src/app/api/auth/register/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:N}=m,f="/api/auth/register/route";function _(){return(0,o.patchFetch)({serverHooks:N,staticGenerationAsyncStorage:h})}},5748:(e,t,r)=>{r.d(t,{db:()=>o});var a=r(2237),s=r(9802);let n=(0,a.qn)(process.env.DATABASE_URL),o=(0,s.tS)(n)},7327:(e,t,r)=>{r.d(t,{HH:()=>c,VV:()=>p,rC:()=>d});var a=r(3733),s=r(5961),n=r(1401),o=r(2140),l=r(1575),u=r(2941),i=r(8748);let d=(0,a.af)("users",{id:(0,s.eP)("id").primaryKey(),username:(0,n.L7)("username",{length:50}).unique().notNull(),password:(0,o.fL)("password").notNull(),email:(0,n.L7)("email",{length:255}),role:(0,n.L7)("role",{length:20}).default("user").notNull(),createdAt:(0,l.AB)("created_at").defaultNow().notNull(),updatedAt:(0,l.AB)("updated_at").defaultNow().notNull()}),p=(0,a.af)("cadets",{id:(0,s.eP)("id").primaryKey(),name:(0,n.L7)("name",{length:255}).notNull(),battalion:(0,n.L7)("battalion",{length:100}).notNull(),company:(0,n.L7)("company",{length:50}).notNull(),joinDate:(0,l.AB)("join_date").notNull(),status:(0,n.L7)("status",{length:20}).default("Active").notNull(),healthStatus:(0,n.L7)("health_status",{length:20}).default("Fit").notNull(),academyNumber:(0,u._L)("academy_number"),height:(0,u._L)("height"),weight:(0,u._L)("weight"),age:(0,u._L)("age"),course:(0,n.L7)("course",{length:100}),sex:(0,n.L7)("sex",{length:10}),createdAt:(0,l.AB)("created_at").defaultNow().notNull(),updatedAt:(0,l.AB)("updated_at").defaultNow().notNull()}),c=(0,a.af)("medical_records",{id:(0,s.eP)("id").primaryKey(),cadetId:(0,u._L)("cadet_id").references(()=>p.id).notNull(),dateOfReporting:(0,l.AB)("date_of_reporting").notNull(),medicalProblem:(0,o.fL)("medical_problem").notNull(),diagnosis:(0,o.fL)("diagnosis"),status:(0,n.L7)("status",{length:20}).default("Active").notNull(),attendC:(0,u._L)("attend_c").default(0).notNull(),trainingDaysMissed:(0,u._L)("training_days_missed").default(0),monitoringCase:(0,i.O7)("monitoring_case").default(!1).notNull(),contactNo:(0,n.L7)("contact_no",{length:20}),remarks:(0,o.fL)("remarks"),createdAt:(0,l.AB)("created_at").defaultNow().notNull(),updatedAt:(0,l.AB)("updated_at").defaultNow().notNull()})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,351,691],()=>r(5013));module.exports=a})();