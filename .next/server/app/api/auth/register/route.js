"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},5013:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>_,patchFetch:()=>f,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>N,staticGenerationAsyncStorage:()=>h});var r={};a.r(r),a.d(r,{POST:()=>c});var n=a(9303),l=a(8716),o=a(670),s=a(7070),u=a(8691),d=a(5748),i=a(7327),p=a(7745);async function c(e){try{let{username:t,password:a,email:r,role:n}=await e.json();if(!t||!a)return s.NextResponse.json({error:"Username and password are required"},{status:400});let[l]=await d.db.select().from(i.rC).where((0,p.eq)(i.rC.username,t)).limit(1);if(l)return s.NextResponse.json({error:"Username already exists"},{status:409});let o=await u.ZP.hash(a,12),[c]=await d.db.insert(i.rC).values({username:t,password:o,email:r,role:n||"user"}).returning({id:i.rC.id,username:i.rC.username,email:i.rC.email,role:i.rC.role,createdAt:i.rC.createdAt});return s.NextResponse.json({message:"User created successfully",user:c})}catch(e){return console.error("Registration error:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}let m=new n.AppRouteRouteModule({definition:{kind:l.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"/Users/ankushjha/Desktop/CURACADET/src/app/api/auth/register/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:N}=m,_="/api/auth/register/route";function f(){return(0,o.patchFetch)({serverHooks:N,staticGenerationAsyncStorage:h})}},5748:(e,t,a)=>{a.d(t,{db:()=>o});var r=a(2237),n=a(9802);let l=(0,r.qn)(process.env.DATABASE_URL),o=(0,n.tS)(l)},7327:(e,t,a)=>{a.d(t,{HH:()=>c,VV:()=>p,rC:()=>i});var r=a(3733),n=a(5961),l=a(1401),o=a(2140),s=a(1575),u=a(2941),d=a(8748);let i=(0,r.af)("users",{id:(0,n.eP)("id").primaryKey(),username:(0,l.L7)("username",{length:50}).unique().notNull(),password:(0,o.fL)("password").notNull(),email:(0,l.L7)("email",{length:255}),role:(0,l.L7)("role",{length:20}).default("user").notNull(),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),p=(0,r.af)("cadets",{id:(0,n.eP)("id").primaryKey(),name:(0,l.L7)("name",{length:255}).notNull(),battalion:(0,l.L7)("battalion",{length:100}).notNull(),company:(0,l.L7)("company",{length:50}).notNull(),joinDate:(0,s.AB)("join_date").notNull(),academyNumber:(0,u._L)("academy_number"),height:(0,u._L)("height"),weight:(0,u._L)("weight"),age:(0,u._L)("age"),course:(0,l.L7)("course",{length:100}),sex:(0,l.L7)("sex",{length:10}),relegated:(0,l.L7)("relegated",{length:1}).default("N").notNull(),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),c=(0,r.af)("medical_records",{id:(0,n.eP)("id").primaryKey(),cadetId:(0,u._L)("cadet_id").references(()=>p.id).notNull(),dateOfReporting:(0,s.AB)("date_of_reporting").notNull(),medicalProblem:(0,o.fL)("medical_problem").notNull(),diagnosis:(0,o.fL)("diagnosis"),medicalStatus:(0,l.L7)("medical_status",{length:20}).default("Active").notNull(),attendC:(0,u._L)("attend_c").default(0).notNull(),miDetained:(0,u._L)("mi_detained").default(0).notNull(),exPpg:(0,u._L)("ex_ppg").default(0).notNull(),attendB:(0,u._L)("attend_b").default(0).notNull(),physiotherapy:(0,u._L)("physiotherapy").default(0).notNull(),totalTrainingDaysMissed:(0,u._L)("total_training_days_missed").default(0).notNull(),monitoringCase:(0,d.O7)("monitoring_case").default(!1).notNull(),contactNo:(0,l.L7)("contact_no",{length:20}),remarks:(0,o.fL)("remarks"),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()})}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[276,351,691],()=>a(5013));module.exports=r})();