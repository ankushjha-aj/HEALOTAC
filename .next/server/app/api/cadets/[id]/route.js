"use strict";(()=>{var e={};e.id=315,e.ids=[315],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5308:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>D,patchFetch:()=>A,requestAsyncStorage:()=>h,routeModule:()=>f,serverHooks:()=>N,staticGenerationAsyncStorage:()=>m});var r={};a.r(r),a.d(r,{DELETE:()=>g,GET:()=>c,PUT:()=>p});var n=a(9303),o=a(8716),d=a(670),s=a(7070),u=a(5748),l=a(7327),i=a(7745);async function c(e,{params:t}){try{let e=parseInt(t.id),[a]=await u.db.select().from(l.VV).where((0,i.eq)(l.VV.id,e)).limit(1);if(!a)return s.NextResponse.json({error:"Cadet not found"},{status:404});return s.NextResponse.json(a)}catch(e){return console.error("❌ Error fetching cadet:",e),s.NextResponse.json({error:"Failed to fetch cadet"},{status:500})}}async function p(e,{params:t}){try{let{name:a,battalion:r,company:n,joinDate:o,status:d,healthStatus:c,height:p,weight:g,age:f,course:h,sex:m}=await e.json(),[N]=await u.db.update(l.VV).set({name:a,battalion:r,company:n,joinDate:o?new Date(o):void 0,status:d,healthStatus:c,height:"number"==typeof p?p:p?parseInt(p):void 0,weight:"number"==typeof g?g:g?parseInt(g):void 0,age:"number"==typeof f?f:f?parseInt(f):void 0,course:h,sex:m,updatedAt:new Date}).where((0,i.eq)(l.VV.id,parseInt(t.id))).returning();if(!N)return s.NextResponse.json({error:"Cadet not found"},{status:404});return console.log("\uD83D\uDD04 UPDATED CADET:",N),s.NextResponse.json(N)}catch(e){return console.error("❌ Error updating cadet:",e),s.NextResponse.json({error:"Failed to update cadet"},{status:500})}}async function g(e,{params:t}){try{let e=parseInt(t.id);await u.db.delete(l.HH).where((0,i.eq)(l.HH.cadetId,e)),console.log("\uD83D\uDDD1️ DELETED MEDICAL RECORDS for cadet ID:",e);let[a]=await u.db.delete(l.VV).where((0,i.eq)(l.VV.id,e)).returning();if(!a)return s.NextResponse.json({error:"Cadet not found"},{status:404});return console.log("\uD83D\uDDD1️ DELETED CADET:",a),s.NextResponse.json({message:"Cadet and associated medical records deleted successfully",deletedCadet:a})}catch(e){return console.error("❌ Error deleting cadet:",e),s.NextResponse.json({error:"Failed to delete cadet"},{status:500})}}let f=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/cadets/[id]/route",pathname:"/api/cadets/[id]",filename:"route",bundlePath:"app/api/cadets/[id]/route"},resolvedPagePath:"/Users/ankushjha/Desktop/CURACADET/src/app/api/cadets/[id]/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:N}=f,D="/api/cadets/[id]/route";function A(){return(0,d.patchFetch)({serverHooks:N,staticGenerationAsyncStorage:m})}},5748:(e,t,a)=>{a.d(t,{db:()=>d});var r=a(2237),n=a(9802);let o=(0,r.qn)(process.env.DATABASE_URL),d=(0,n.tS)(o)},7327:(e,t,a)=>{a.d(t,{HH:()=>p,VV:()=>c,rC:()=>i});var r=a(3733),n=a(5961),o=a(1401),d=a(2140),s=a(1575),u=a(2941),l=a(8748);let i=(0,r.af)("users",{id:(0,n.eP)("id").primaryKey(),username:(0,o.L7)("username",{length:50}).unique().notNull(),password:(0,d.fL)("password").notNull(),email:(0,o.L7)("email",{length:255}),role:(0,o.L7)("role",{length:20}).default("user").notNull(),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),c=(0,r.af)("cadets",{id:(0,n.eP)("id").primaryKey(),name:(0,o.L7)("name",{length:255}).notNull(),battalion:(0,o.L7)("battalion",{length:100}).notNull(),company:(0,o.L7)("company",{length:50}).notNull(),joinDate:(0,s.AB)("join_date").notNull(),status:(0,o.L7)("status",{length:20}).default("Active").notNull(),healthStatus:(0,o.L7)("health_status",{length:20}).default("Fit").notNull(),academyNumber:(0,u._L)("academy_number"),height:(0,u._L)("height"),weight:(0,u._L)("weight"),age:(0,u._L)("age"),course:(0,o.L7)("course",{length:100}),sex:(0,o.L7)("sex",{length:10}),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),p=(0,r.af)("medical_records",{id:(0,n.eP)("id").primaryKey(),cadetId:(0,u._L)("cadet_id").references(()=>c.id).notNull(),dateOfReporting:(0,s.AB)("date_of_reporting").notNull(),medicalProblem:(0,d.fL)("medical_problem").notNull(),diagnosis:(0,d.fL)("diagnosis"),status:(0,o.L7)("status",{length:20}).default("Active").notNull(),attendC:(0,u._L)("attend_c").default(0).notNull(),trainingDaysMissed:(0,u._L)("training_days_missed").default(0),monitoringCase:(0,l.O7)("monitoring_case").default(!1).notNull(),contactNo:(0,o.L7)("contact_no",{length:20}),remarks:(0,d.fL)("remarks"),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()})}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[948,351],()=>a(5308));module.exports=r})();