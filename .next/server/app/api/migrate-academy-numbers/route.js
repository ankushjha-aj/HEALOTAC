"use strict";(()=>{var e={};e.id=221,e.ids=[221],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6902:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>f,patchFetch:()=>N,requestAsyncStorage:()=>p,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var r={};a.r(r),a.d(r,{POST:()=>c});var n=a(9303),l=a(8716),s=a(670),o=a(7070),u=a(5748),d=a(7327),i=a(7745);async function c(e){try{console.log("\uD83D\uDE80 Starting Academy Number Migration...");let e=await u.db.select().from(d.VV).where((0,i.eq)(d.VV.academyNumber,null));if(console.log(`ðŸ“Š Found ${e.length} cadets without academy numbers`),0===e.length)return o.NextResponse.json({success:!0,message:"All cadets already have academy numbers!",updated:0});let t=[];for(let a=0;a<e.length;a++){let r=e[a],n=1e4+r.id;await u.db.update(d.VV).set({academyNumber:n}).where((0,i.eq)(d.VV.id,r.id)),t.push({id:r.id,name:r.name,academyNumber:n})}return console.log("\uD83C\uDF89 Academy Number Migration Complete!"),o.NextResponse.json({success:!0,message:`Successfully updated ${e.length} cadets with academy numbers`,updated:e.length,cadets:t})}catch(e){return console.error("âŒ Migration failed:",e),o.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Migration failed"},{status:500})}}let m=new n.AppRouteRouteModule({definition:{kind:l.x.APP_ROUTE,page:"/api/migrate-academy-numbers/route",pathname:"/api/migrate-academy-numbers",filename:"route",bundlePath:"app/api/migrate-academy-numbers/route"},resolvedPagePath:"/Users/ankushjha/Desktop/CURACADET/src/app/api/migrate-academy-numbers/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:g,serverHooks:h}=m,f="/api/migrate-academy-numbers/route";function N(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},5748:(e,t,a)=>{a.d(t,{db:()=>s});var r=a(2237),n=a(9802);let l=(0,r.qn)(process.env.DATABASE_URL),s=(0,n.tS)(l)},7327:(e,t,a)=>{a.d(t,{HH:()=>m,VV:()=>c,rC:()=>i});var r=a(3733),n=a(5961),l=a(1401),s=a(2140),o=a(1575),u=a(2941),d=a(8748);let i=(0,r.af)("users",{id:(0,n.eP)("id").primaryKey(),username:(0,l.L7)("username",{length:50}).unique().notNull(),password:(0,s.fL)("password").notNull(),email:(0,l.L7)("email",{length:255}),role:(0,l.L7)("role",{length:20}).default("user").notNull(),createdAt:(0,o.AB)("created_at").defaultNow().notNull(),updatedAt:(0,o.AB)("updated_at").defaultNow().notNull()}),c=(0,r.af)("cadets",{id:(0,n.eP)("id").primaryKey(),name:(0,l.L7)("name",{length:255}).notNull(),battalion:(0,l.L7)("battalion",{length:100}).notNull(),company:(0,l.L7)("company",{length:50}).notNull(),joinDate:(0,o.AB)("join_date").notNull(),status:(0,l.L7)("status",{length:20}).default("Active").notNull(),healthStatus:(0,l.L7)("health_status",{length:20}).default("Fit").notNull(),academyNumber:(0,u._L)("academy_number"),height:(0,u._L)("height"),weight:(0,u._L)("weight"),age:(0,u._L)("age"),course:(0,l.L7)("course",{length:100}),sex:(0,l.L7)("sex",{length:10}),createdAt:(0,o.AB)("created_at").defaultNow().notNull(),updatedAt:(0,o.AB)("updated_at").defaultNow().notNull()}),m=(0,r.af)("medical_records",{id:(0,n.eP)("id").primaryKey(),cadetId:(0,u._L)("cadet_id").references(()=>c.id).notNull(),dateOfReporting:(0,o.AB)("date_of_reporting").notNull(),medicalProblem:(0,s.fL)("medical_problem").notNull(),diagnosis:(0,s.fL)("diagnosis"),status:(0,l.L7)("status",{length:20}).default("Active").notNull(),attendC:(0,u._L)("attend_c").default(0).notNull(),trainingDaysMissed:(0,u._L)("training_days_missed").default(0),monitoringCase:(0,d.O7)("monitoring_case").default(!1).notNull(),contactNo:(0,l.L7)("contact_no",{length:20}),remarks:(0,s.fL)("remarks"),createdAt:(0,o.AB)("created_at").defaultNow().notNull(),updatedAt:(0,o.AB)("updated_at").defaultNow().notNull()})}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[276,351],()=>a(6902));module.exports=r})();